<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="anfieldqi">
  
  
  
  
  <link rel="next" href="http://anfieldqi.top/2020/hugo-github-pages/" />
  <link rel="canonical" href="http://anfieldqi.top/2020/flask%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Flask框架学习 | AnfieldQi`s Blog
       
  </title>
  <meta name="title" content="Flask框架学习 | AnfieldQi`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "http:\/\/anfieldqi.top"
    },
    "articleSection" : "posts",
    "name" : "Flask框架学习",
    "headline" : "Flask框架学习",
    "description" : "Flask框架 1.安装flask 安装flask框架并在项目中导入 2.基本文件结构 static:存放静态资源，图片，js,css等 templa",
    "inLanguage" : "zh-cn",
    "author" : "anfieldqi",
    "creator" : "anfieldqi",
    "publisher": "anfieldqi",
    "accountablePerson" : "anfieldqi",
    "copyrightHolder" : "anfieldqi",
    "copyrightYear" : "2020",
    "datePublished": "2020-04-11 16:28:09 \x2b0800 CST",
    "dateModified" : "2020-04-11 16:28:09 \x2b0800 CST",
    "url" : "http:\/\/anfieldqi.top\/2020\/flask%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95\/",
    "wordCount" : "2674",
    "keywords" : [ "python flask", "AnfieldQi`s Blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
    <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://anfieldqi.top">AnfieldQi`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://anfieldqi.top">AnfieldQi`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Flask框架学习</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="http://anfieldqi.top" rel="author">anfieldqi</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-04-11 itemprop="datePublished">April 11, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="http://anfieldqi.top/categories/python/"> python </a>
                        
                </span>
                <span class="post-word-count">, 2674 words</span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h3 id="flask框架">Flask框架</h3>
<h4 id="1安装flask">1.安装flask</h4>
<blockquote>
<p>安装flask框架并在项目中导入</p>
</blockquote>
<h4 id="2基本文件结构">2.基本文件结构</h4>
<blockquote>
<p>static:存放静态资源，图片，js,css等
templates:存放模板文件
server.py：网站的逻辑</p>
</blockquote>
<h4 id="3获取url参数">3.获取URL参数</h4>
<blockquote>
<p>列出所有URL参数:request.args.<strong>str</strong>()
查看传给flask的数据：request.full_path request.path</p>
</blockquote>
<h5 id="31-获取某个指定的参数">3.1 获取某个指定的参数</h5>
<blockquote>
<p>浏览器：http://127.0.0.1:5000/?info=hello
后端：request.args.get(&lsquo;info&rsquo;)
flask不允许返回None</p>
</blockquote>
<h5 id="32处理多值">3.2处理多值</h5>
<blockquote>
<p>使用request.args.getlist(&lsquo;p&rsquo;)</p>
</blockquote>
<h4 id="4获取post方法传送的数据">4.获取POST方法传送的数据</h4>
<p>服务端：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request

app <span style="color:#f92672">=</span> Flask(__name__)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/register&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">register</span>():
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>headers)
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>stream<span style="color:#f92672">.</span>read())
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;welcome&#39;</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
    
</code></pre></div><p>客户端：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> requests

user_info <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;letian&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;123&#39;</span>}
r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#34;http://127.0.0.1:5000/register&#34;</span>, data<span style="color:#f92672">=</span>user_info)

<span style="color:#66d9ef">print</span>(r<span style="color:#f92672">.</span>text)
</code></pre></div><blockquote>
<p>解析post数据：request.form</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request

app <span style="color:#f92672">=</span> Flask(__name__)

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/register&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">register</span>():
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>headers)
    <span style="color:#75715e"># print(request.stream.read()) # 不要用，否则下面的form取不到数据</span>
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form)
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#39;name&#39;</span>])
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;name&#39;</span>))
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>getlist(<span style="color:#e6db74">&#39;name&#39;</span>))
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;nickname&#39;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;little apple&#39;</span>)) <span style="color:#75715e">#可以设默认值</span>
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;welcome&#39;</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><h4 id="5处理和响应json数据">5.处理和响应JSON数据</h4>
<blockquote>
<p>使用 HTTP POST 方法传到网站服务器的数据格式可以有很多种，比如name=letian&amp;password=123这种用过&amp;符号分割的key-value键值对格式。也可以用JSON格式、XML格式。相比XML的重量、规范繁琐，JSON显得非常小巧和易用</p>
</blockquote>
<blockquote>
<p>处理json格式的请求数据：request.json</p>
</blockquote>
<p><strong>响应json-方法1：response</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request, Response
<span style="color:#f92672">import</span> json

app <span style="color:#f92672">=</span> Flask(<span style="color:#e6db74">&#34;my-app&#34;</span>)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Hello World!&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/add&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>():
    result <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;sum&#39;</span>: request<span style="color:#f92672">.</span>json[<span style="color:#e6db74">&#39;a&#39;</span>] <span style="color:#f92672">+</span> request<span style="color:#f92672">.</span>json[<span style="color:#e6db74">&#39;b&#39;</span>]}
    <span style="color:#66d9ef">return</span> Response(json<span style="color:#f92672">.</span>dumps(result),  mimetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;application/json&#39;</span>)<span style="color:#75715e">#响应头设置为json</span>
    resp<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Server&#39;</span>, <span style="color:#e6db74">&#39;python flask&#39;</span><span style="color:#960050;background-color:#1e0010">）</span><span style="color:#75715e">#为相应头添加东西</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;127.0.0.1&#39;</span>, port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><p><strong>响应json-方法2：使用jsonify</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request, jsonify

app <span style="color:#f92672">=</span> Flask(<span style="color:#e6db74">&#34;my-app&#34;</span>)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Hello World!&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/add&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>():
    result <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;sum&#39;</span>: request<span style="color:#f92672">.</span>json[<span style="color:#e6db74">&#39;a&#39;</span>] <span style="color:#f92672">+</span> request<span style="color:#f92672">.</span>json[<span style="color:#e6db74">&#39;b&#39;</span>]}
    <span style="color:#66d9ef">return</span> jsonify(result)


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;127.0.0.1&#39;</span>, port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><h4 id="6上传文件">6.上传文件</h4>
<blockquote>
<p>假设将上传的图片只允许&rsquo;png&rsquo;、&lsquo;jpg&rsquo;、&lsquo;jpeg&rsquo;、&lsquo;gif'这四种格式，通过url/upload使用POST上传，上传的图片存放在服务器端的static/uploads目录下。</p>
</blockquote>
<blockquote>
<p>werkzeug库可以判断文件名是否安全，例如防止文件名是../../../a.png，安装这个库：</p>
</blockquote>
<p>服务端：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request

<span style="color:#f92672">from</span> werkzeug.utils <span style="color:#f92672">import</span> secure_filename
<span style="color:#f92672">import</span> os

app <span style="color:#f92672">=</span> Flask(__name__)

<span style="color:#75715e"># 文件上传目录</span>
app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;UPLOAD_FOLDER&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;static/uploads/&#39;</span><span style="color:#75715e"># 支持的文件格式</span>
app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;ALLOWED_EXTENSIONS&#39;</span>] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;png&#39;</span>, <span style="color:#e6db74">&#39;jpg&#39;</span>, <span style="color:#e6db74">&#39;jpeg&#39;</span>, <span style="color:#e6db74">&#39;gif&#39;</span>}  <span style="color:#75715e"># 集合类型</span>


<span style="color:#75715e"># 判断文件名是否是我们支持的格式def allowed_file(filename):</span>
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;.&#39;</span> <span style="color:#f92672">in</span> filename <span style="color:#f92672">and</span> \
           filename<span style="color:#f92672">.</span>rsplit(<span style="color:#e6db74">&#39;.&#39;</span>, <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">in</span> app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;ALLOWED_EXTENSIONS&#39;</span>]


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/upload&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">upload</span>():
    upload_file <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>files[<span style="color:#e6db74">&#39;image&#39;</span>]
    <span style="color:#66d9ef">if</span> upload_file <span style="color:#f92672">and</span> allowed_file(upload_file<span style="color:#f92672">.</span>filename):
        filename <span style="color:#f92672">=</span> secure_filename(upload_file<span style="color:#f92672">.</span>filename)
        <span style="color:#75715e"># 将文件保存到 static/uploads 目录，文件名同上传时使用的文件名</span>
        upload_file<span style="color:#f92672">.</span>save(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(app<span style="color:#f92672">.</span>root_path, app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;UPLOAD_FOLDER&#39;</span>], filename))
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;info is &#39;</span><span style="color:#f92672">+</span>request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;info&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;. success&#39;</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;failed&#39;</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><p>客户端：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> requests

file_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;image&#39;</span>: open(<span style="color:#e6db74">&#39;Lenna.jpg&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>)}

user_info <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;info&#39;</span>: <span style="color:#e6db74">&#39;Lenna&#39;</span>}

r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#34;http://127.0.0.1:5000/upload&#34;</span>, data<span style="color:#f92672">=</span>user_info, files<span style="color:#f92672">=</span>file_data)

<span style="color:#66d9ef">print</span>(r<span style="color:#f92672">.</span>text)
</code></pre></div><p>运行client.py，当前目录下的Lenna.jpg将上传到服务器。然后，我们可以在static/uploads中看到文件Lenna.jpg。要控制上产文件的大小，可以设置请求实体的大小，例如：</p>
<p>app.config[&lsquo;MAX_CONTENT_LENGTH&rsquo;] = 16 * 1024 * 1024 #16MB</p>
<h4 id="7restful-url">7.Restful URL</h4>
<blockquote>
<p>Restful URL可以看做是对 URL 参数的替代</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/user/&lt;username&gt;&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user</span>(username):
    <span style="color:#66d9ef">print</span>(username)
    <span style="color:#66d9ef">print</span>(type(username))
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello &#39;</span> <span style="color:#f92672">+</span> username


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/user/&lt;username&gt;/friends&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_friends</span>(username):
    <span style="color:#66d9ef">print</span>(username)
    <span style="color:#66d9ef">print</span>(type(username))
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello &#39;</span> <span style="color:#f92672">+</span> username
</code></pre></div><blockquote>
<p>访问http://127.0.0.1:5000/user/letian 
输出：</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">letian
<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">str</span><span style="color:#e6db74">&#39;&gt;</span>
</code></pre></div><h5 id="71-转换类型">7.1 转换类型</h5>
<blockquote>
<p>使用 Restful URL 得到的变量默认为str对象。如果我们需要通过分页显示查询结果，那么需要在url中有数字来指定页数。用flask内置的转换机制，即在route中指定该如何转换。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/page/&lt;int:num&gt;&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">page</span>(num):
    <span style="color:#66d9ef">print</span>(num)
    <span style="color:#66d9ef">print</span>(type(num))
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/page/&lt;int:num1&gt;-&lt;int:num2&gt;&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">page</span>(num1, num2):
    <span style="color:#66d9ef">print</span>(num1)
    <span style="color:#66d9ef">print</span>(num2)
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>
</code></pre></div><p>注意这里只有三张类型可以转换：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>accepts integers</td>
</tr>
<tr>
<td>float</td>
<td>like int but for floating point values</td>
</tr>
<tr>
<td>path</td>
<td>like the default but also accepts slashes</td>
</tr>
</tbody>
</table>
<h5 id="72-编写转换器">7.2 编写转换器</h5>
<blockquote>
<p>继承自：werkzeug.routing.BaseConverter
修改：to_python和to_url
to_python方法用于将url中的变量转换后供被@app.route包装的函数使用，
to_url方法用于flask.url_for中的参数转换。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">app<span style="color:#f92672">.</span>url_map<span style="color:#f92672">.</span>converters[<span style="color:#e6db74">&#39;my_int&#39;</span>] <span style="color:#f92672">=</span> MyIntConverter
</code></pre></div><h4 id="8使用url_for生成连接">8.使用url_for生成连接</h4>
<blockquote>
<p>url_for可以生成url软连接</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, url_for

app <span style="color:#f92672">=</span> Flask(__name__)

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">pass</span>

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/user/&lt;name&gt;&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user</span>(name):
    <span style="color:#66d9ef">pass</span>

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/page/&lt;int:num&gt;&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">page</span>(num):
    <span style="color:#66d9ef">pass</span>

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/test&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test</span>():
    <span style="color:#66d9ef">print</span>(url_for(<span style="color:#e6db74">&#39;hello_world&#39;</span>))
    <span style="color:#66d9ef">print</span>(url_for(<span style="color:#e6db74">&#39;user&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;letian&#39;</span>))
    <span style="color:#66d9ef">print</span>(url_for(<span style="color:#e6db74">&#39;page&#39;</span>, num<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, q<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hadoop mapreduce 10%3&#39;</span>))
    <span style="color:#66d9ef">print</span>(url_for(<span style="color:#e6db74">&#39;static&#39;</span>, filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;uploads/01.jpg&#39;</span>))
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Hello&#39;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(debug<span style="color:#f92672">=</span>True)
</code></pre></div><h4 id="9使用redirect重定向网址">9.使用redirect重定向网址</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, url_for, redirect

app <span style="color:#f92672">=</span> Flask(__name__)

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/test1&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test1</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;this is test1&#39;</span>)
    <span style="color:#66d9ef">return</span> redirect(url_for(<span style="color:#e6db74">&#39;test2&#39;</span>))

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/test2&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test2</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;this is test2&#39;</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;this is test2&#39;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(debug<span style="color:#f92672">=</span>True)
</code></pre></div><h4 id="10使用jinja2模板引擎">10.使用jinja2模板引擎</h4>
<blockquote>
<p>给模板传递变量render_template(&lsquo;user_info.html&rsquo;, page_title='letian's info&rsquo;, user_info=user_info)</p>
</blockquote>
<h4 id="11自定义404">11.自定义404</h4>
<blockquote>
<p>要处理HTTP错误，可以使用flask.abort函数。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template_string, abort

app <span style="color:#f92672">=</span> Flask(__name__)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/user&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user</span>():
    abort(<span style="color:#ae81ff">401</span>)  <span style="color:#75715e"># Unauthorized 未授权</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Unauthorized, 请先登录&#39;</span>)


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
    
</code></pre></div><p><strong>自定义错误页面</strong></p>
<blockquote>
<p>render_template_string(&lsquo;<!-- raw HTML omitted --> Unauthorized <!-- raw HTML omitted --><!-- raw HTML omitted -->{{ error_info }}<!-- raw HTML omitted -->&rsquo;</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template_string, abort

app <span style="color:#f92672">=</span> Flask(__name__)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/user&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user</span>():
    abort(<span style="color:#ae81ff">401</span>)  <span style="color:#75715e"># Unauthorized</span>


<span style="color:#a6e22e">@app.errorhandler</span>(<span style="color:#ae81ff">401</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">page_unauthorized</span>(error):
    <span style="color:#66d9ef">return</span> render_template_string(<span style="color:#e6db74">&#39;&lt;h1&gt; Unauthorized &lt;/h1&gt;&lt;h2&gt;{{ error_info }}&lt;/h2&gt;&#39;</span>, error_info<span style="color:#f92672">=</span>error), <span style="color:#ae81ff">401</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><h4 id="12用户会话">12.用户会话</h4>
<blockquote>
<p>session用来记录用户的登录状态，一般基于cookie实现。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template_string, \
    session, request, redirect, url_for

app <span style="color:#f92672">=</span> Flask(__name__)

app<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;F12Zr47j</span><span style="color:#ae81ff">\3</span><span style="color:#e6db74">yX R~X@H!jLwf/T&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello_world</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hello world&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/login&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">login</span>():
    page <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;
</span><span style="color:#e6db74">    &lt;form action=&#34;{{ url_for(&#39;do_login&#39;) }}&#34; method=&#34;post&#34;&gt;
</span><span style="color:#e6db74">        &lt;p&gt;name: &lt;input type=&#34;text&#34; name=&#34;user_name&#34; /&gt;&lt;/p&gt;
</span><span style="color:#e6db74">        &lt;input type=&#34;submit&#34; value=&#34;Submit&#34; /&gt;
</span><span style="color:#e6db74">    &lt;/form&gt;
</span><span style="color:#e6db74">    &#39;&#39;&#39;</span>
    <span style="color:#66d9ef">return</span> render_template_string(page)


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/do_login&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;POST&#39;</span>])<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">do_login</span>():
    name <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;user_name&#39;</span>)
    session[<span style="color:#e6db74">&#39;user_name&#39;</span>] <span style="color:#f92672">=</span> name
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;success&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/show&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show</span>():
    <span style="color:#66d9ef">return</span> session[<span style="color:#e6db74">&#39;user_name&#39;</span>]


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/logout&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">logout</span>():
    session<span style="color:#f92672">.</span>pop(<span style="color:#e6db74">&#39;user_name&#39;</span>, None)
    <span style="color:#66d9ef">return</span> redirect(url_for(<span style="color:#e6db74">&#39;login&#39;</span>))


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
    
</code></pre></div><blockquote>
<p>1.app.secret_key用于给session加密
2.在/login中将向用户展示一个表单，要求输入一个名字，submit后将数据以post的方式传递给/do_login
3./do_login将名字存放在session中
4.如果用户成功登录，访问/show时会显示用户的名字。此时，打开firebug等调试工具，选择session面板，会看到有一个cookie的名称为session
5./logout用于登出，通过将session中的user_name字段pop即可。Flask中的session基于字典类型实现，调用pop方法时会返回pop的键对应的值；如果要pop的键并不存在，那么返回值是pop()的第二个参数。另外，使用redirect()重定向时，一定要在前面加上return</p>
</blockquote>
<h6 id="设置sessin的有效时间">设置sessin的有效时间</h6>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> timedelta
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> session, app

session<span style="color:#f92672">.</span>permanent <span style="color:#f92672">=</span> True
app<span style="color:#f92672">.</span>permanent_session_lifetime <span style="color:#f92672">=</span> timedelta(minutes<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</code></pre></div><h4 id="13使用闪存系统">13.使用闪存系统</h4>
<blockquote>
<p>Flask的闪存系统（flashing system）用于向用户提供反馈信息，这些反馈信息一般是对用户上一次操作的反馈。反馈信息是存储在服务器端的，当服务器向客户端返回反馈信息后，这些反馈信息会被服务器端删除。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, flash, get_flashed_messages
<span style="color:#f92672">import</span> time

app <span style="color:#f92672">=</span> Flask(__name__)
app<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;some_secret&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">index</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hi&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/gen&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen</span>():
    info <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;access at &#39;</span><span style="color:#f92672">+</span> time<span style="color:#f92672">.</span>time()<span style="color:#f92672">.</span>__str__()
    flash(info)
    <span style="color:#66d9ef">return</span> info


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/show1&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show1</span>():
    <span style="color:#66d9ef">return</span> get_flashed_messages()<span style="color:#f92672">.</span>__str__()


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/show2&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show2</span>():
    <span style="color:#66d9ef">return</span> get_flashed_messages()<span style="color:#f92672">.</span>__str__()


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div><blockquote>
<p>访问http://127.0.0.1:5000/gen 显示:access at 1404020982.83
查看cookie:
查看show1：可以看到连接记录</p>
</blockquote>
<p><strong>对flash分类</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, flash, get_flashed_messages
<span style="color:#f92672">import</span> time

app <span style="color:#f92672">=</span> Flask(__name__)
app<span style="color:#f92672">.</span>secret_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;some_secret&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">index</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;hi&#39;</span>


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/gen&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen</span>():
    info <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;access at &#39;</span><span style="color:#f92672">+</span> time<span style="color:#f92672">.</span>time()<span style="color:#f92672">.</span>__str__()
    flash(<span style="color:#e6db74">&#39;show1 &#39;</span><span style="color:#f92672">+</span>info, category<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;show1&#39;</span>)
    flash(<span style="color:#e6db74">&#39;show2 &#39;</span><span style="color:#f92672">+</span>info, category<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;show2&#39;</span>)
    <span style="color:#66d9ef">return</span> info


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/show1&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show1</span>():
    <span style="color:#66d9ef">return</span> get_flashed_messages(category_filter<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;show1&#39;</span>)<span style="color:#f92672">.</span>__str__()

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/show2&#39;</span>)<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show2</span>():
    <span style="color:#66d9ef">return</span> get_flashed_messages(category_filter<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;show2&#39;</span>)<span style="color:#f92672">.</span>__str__()


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    app<span style="color:#f92672">.</span>run(port<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>, debug<span style="color:#f92672">=</span>True)
</code></pre></div>
    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>anfieldqi </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=http://anfieldqi.top/2020/flask%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/>http://anfieldqi.top/2020/flask%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                除特别标注，文章采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="http://anfieldqi.top/tags/python-flask/">
                    #python flask</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="http://anfieldqi.top">home</a></span>
        </section>
    </div>

    <div class="post-nav">
         
        
        <a href="http://anfieldqi.top/2020/hugo-github-pages/" class="next" rel="next" title="Hugo&#43;Github Pages">Hugo&#43;Github Pages&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
          
<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  const gitalk = new Gitalk({
    clientID: '10430486a804bdce5dd3',
    clientSecret: 'b8c2e27fc2de4a7e7f9e80094cebbf2601134eea',
    repo: 'AnfieldQi.github.io',
    owner: 'AnfieldQi',
    admin: ['AnfieldQi'],
    id: location.pathname, 
    distractionFreeMode: false 
  });
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
      return;
    }
    gitalk.render('gitalk-container');
  })();
</script>

    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="http://anfieldqi.top">anfieldqi</a> | </span> 
         

         
            <a href="http://www.beian.miit.gov.cn/" target="_blank" rel="external nofollow">京ICP备20032128号 </a> |
         
		  <span>power by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> </span> 
    </div>
</footer>













    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>

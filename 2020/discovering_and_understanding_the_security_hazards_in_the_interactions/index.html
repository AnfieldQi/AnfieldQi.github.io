<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="anfieldqi">
  
  
  
  <link rel="prev" href="http://anfieldqi.top/2020/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94_%E5%A6%82%E4%BB%8A%E5%80%BE%E5%B0%BD%E5%85%A5%E6%B5%B7%E6%B5%81/" />
  <link rel="next" href="http://anfieldqi.top/2020/%E5%9B%BA%E4%BB%B6%E6%94%BB%E5%87%BB%E9%9D%A2%E6%80%BB%E7%BB%93/" />
  <link rel="canonical" href="http://anfieldqi.top/2020/discovering_and_understanding_the_security_hazards_in_the_interactions/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           论文:Discovering_and_understanding_the_security_hazards_in_the_interactions | AnfieldQi`s Blog
       
  </title>
  <meta name="title" content="论文:Discovering_and_understanding_the_security_hazards_in_the_interactions | AnfieldQi`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "http:\/\/anfieldqi.top"
    },
    "articleSection" : "posts",
    "name" : "论文:Discovering_and_understanding_the_security_hazards_in_the_interactions",
    "headline" : "论文:Discovering_and_understanding_the_security_hazards_in_the_interactions",
    "description" : "1.题目 Discovering and Understanding the Security Hazards in the Interactions between IoT Devices, Mobile Apps, and Clouds on Smart Home Platforms 2.主要内容 2.1 论文内容 本论文研究的主要内容集中在**(1)物联网设备(2)移动APP(3)物",
    "inLanguage" : "zh-cn",
    "author" : "anfieldqi",
    "creator" : "anfieldqi",
    "publisher": "anfieldqi",
    "accountablePerson" : "anfieldqi",
    "copyrightHolder" : "anfieldqi",
    "copyrightYear" : "2020",
    "datePublished": "2020-08-31 14:56:35 \x2b0800 CST",
    "dateModified" : "2020-08-31 14:56:35 \x2b0800 CST",
    "url" : "http:\/\/anfieldqi.top\/2020\/discovering_and_understanding_the_security_hazards_in_the_interactions\/",
    "wordCount" : "2419",
    "keywords" : [ "iot", "AnfieldQi`s Blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
    <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://anfieldqi.top">AnfieldQi`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://anfieldqi.top">AnfieldQi`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">论文:Discovering_and_understanding_the_security_hazards_in_the_interactions</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="http://anfieldqi.top" rel="author">anfieldqi</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-08-31 itemprop="datePublished">August 31, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="http://anfieldqi.top/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"> 论文笔记 </a>
                        
                </span>
                <span class="post-word-count">, 2419 words</span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h4 id="1题目">1.题目</h4>
<p>Discovering and Understanding the Security Hazards in the Interactions between IoT Devices, Mobile Apps, and Clouds on Smart Home Platforms</p>
<h4 id="2主要内容">2.主要内容</h4>
<h5 id="21-论文内容">2.1 论文内容</h5>
<p>本论文研究的主要内容集中在**(1)物联网设备(2)移动APP(3)物联网云**三者**交互过程**中可能存在的安全问题上。针对几种目前被广泛使用的物联网平台，首先，通过**固件逆向工程**和交互过程**MITM监控**来分析出交互流程，基于三个实体的相互作用推导每个实体的**状态转移图**，以此状态转移为基础，识别三者在状态转移时的意外转换，最后通过模拟真实物理设备，介入交互过程，探测分析的意外转换是否真实存在。</p>
<h5 id="22-作者的contribution">2.2 作者的contribution</h5>
<p>发现了针对固件检测的攻击面：</p>
<ol>
<li>攻击人员可以用他控制下的不存在的幻影设备远程替换受害者的真实设备。结果，来自受害者用户的所有控制命令都暴露在虚拟设备中，并进一步暴露给对手，从而导致隐私泄露。对手还可以利用虚拟设备操纵要发送给受害者用户的数据，从而欺骗或误导受害者用户。</li>
<li>对手可以远程接管设备。因此，他可以采集传感器读数来监控受害者的家，甚至操纵智能家居设备，导致数据泄露，危及受害者。</li>
<li>对手可以通过虚拟设备远程解除授权用户的绑定。因此，用户无法再使用其帐户控制设备</li>
<li>对手可以利用虚拟设备误导物联网云，并在设备出售前占用真实设备的身份。当消费者购买设备时，他无法将设备与他的帐户绑定。</li>
<li>对手可以利用虚拟设备自动向物联网云发送更新请求，大规模窃取各种专有固件</li>
</ol>
<h4 id="3技术背景">3.技术背景</h4>
<ol>
<li>不同于基于网络的攻击（MITM）和基于固件的逆向工程。本论文所关注的是试图利用物联网中三种实体交互过程的缺陷。</li>
</ol>
<h4 id="4-攻击模型设计">4. 攻击模型设计</h4>
<h5 id="41-系统功能">4.1 系统功能</h5>
<p>利用家用物联网平台中物联网设备，移动APP 和物联网云服务之间交互运行时可能导致的意外状态。模拟物联网实体设备接入交互，进行漏洞验证。</p>
<h5 id="42-前提条件">4.2 前提条件</h5>
<p>为了虚拟设备的模拟，需要拿到物联网设备的设备身份/合法性信息，一般为mac地址/云生成的唯一ID等信息，论文中针对5大厂商的合法性信息和获取难度已经列在表中，在论文第三章。</p>
<ol>
<li>对于以京东joylink为代表的1型平台，其标识ID是由云服务器传递给设备的，可以通过中间人攻击等进行探测获取，具体方法也在第三章，不过均为一些社会工程学方法。</li>
<li>对于以米家为首的2型设备，其身份信息为硬编码模式，获取方式相对于1更加单一一些，主要就是需要本人可以接触到这个设备，或者在同一个局域网内进行嗅探。不过其在本地设备中存在的漏洞在被发现后可以运程进行利用，仍是一大威胁。</li>
</ol>
<h5 id="43系统结构设计">4.3系统结构设计</h5>
<p>图后面补，还未做</p>
<h5 id="44-系统工作流程">4.4 系统工作流程</h5>
<p>目标平台—&gt;目标设备—&gt;建立基本状态转换关系—&gt;建立设备身份/合法性识别获取—&gt;漏洞分析（关键技术）—&gt;虚拟设备模拟—&gt;介入交互，验证漏洞。</p>
<h4 id="5关键技术实现">5.关键技术实现</h4>
<h5 id="51-解密通信">5.1 解密通信</h5>
<p><strong>云与应用通信</strong>要想获得信息，特别是对于1型设备，对于通信的解密是必须的。一般有以下几种方式。、</p>
<ol>
<li>对于云应用通信，一般平台都采用TLS，可以通过在移动端发起MITM攻击来破译通信，替换云证书</li>
<li>对于移动端硬编码证书的物联网设计，可以通过Xposed动态的对证书进行更换。</li>
</ol>
<p><strong>应用与设备通信</strong>例子：</p>
<ol>
<li>joylink，MIjia:对称加密方式，可以通过分析APK来获取密钥</li>
<li>SmartTing等：TLS传输方式，使用1中的方式进行破译</li>
</ol>
<p><strong>云与设备通信：</strong></p>
<ol>
<li>无法向移动端一样进行证书替换</li>
<li>对设备固件进行动态分析，将固件镜像提取，手动跟踪加密函数的数据和控制流。在固件中定位硬编码证书</li>
<li>在固件镜像中替换硬编码证书，对于固件执行时的强制完整性检测，本论文中涉及的固件都是CRC，我们手动改变CRC的值就行了。</li>
</ol>
<h5 id="52-理解交互信息">5.2 理解交互信息</h5>
<p>使用1中的方法，可以识别移动应用程序与云服务器之间的通信，一般为json字段，这样可以继续进行下一步。</p>
<h5 id="53-模拟设备">5.3 模拟设备</h5>
<p>虚拟设备的构造方法：</p>
<p>（1）利用厂商开源的设备端和演示程序（京东，阿里），他们的通信逻辑与真实的相同，重复使用来制造模拟请求</p>
<p>（2）还有复杂一些的，在真实设备上获得固件进行逆向工程，实现 程序来模拟原始通信功能（目前来说我做不到，所设计的系统中也应该没有这方面的需求）</p>
<p><strong>目前可以做的实验（阿里的（model、MAC和CID）元组和设备ID之间存在一对一的映射）</strong></p>
<h5 id="54-确定设备缺陷">5.4 确定设备缺陷</h5>
<ol>
<li>
<p>边界保护不足</p>
<p>1.1. 1型平台特有，拥有设备标识的攻击者可以使用虚拟设备向云端发送请求。云端会被欺骗，返回信息给攻击者。</p>
<p>1.2. 2型平台特有，攻击者可以使用虚拟设备进行绑定，将设备与攻击者的账户绑定。绑定请求由设备发出，云无条件接受</p>
<p>1.3 云端接受设备注册请求</p>
</li>
<li>
<p>进入非预期状态</p>
<p>2.1. 当用户退出智能家居设备时，应该重置并解除设备的绑定，但对于1型设备，用户在没有重置的时候解除绑定，与云的链接仍然会被保留。攻击者再次发送注册绑定等信息时会直接跳到非预期状态</p>
</li>
<li>
<p>未经授权的设备登录</p>
<p>3.1 设备登录后，设备和物联网之间保持连接，理想情况下如果请求是从绑定所有者帐户的设备发出的，云应该只允许登录请求。但是，我们发现物联网云在设备登录期间不执行任何基于账户的授权检查。换句话说，连接与用户帐户分离。因此，当攻击者使用幻象设备以受害者设备的设备ID登录时，云会被欺骗，从而与幻影设备建立连接</p>
</li>
<li>
<p>未经授权的设备解除绑定</p>
<p>只有拥有当前绑定到设备的帐户的用户才有权解除设备绑定。如果在移动应用程序上执行解除绑定操作，这是真的，这确实包括解除绑定消息中的用户凭据。不幸的是，对于I型平台，设备解除绑定也可以在设备端实现。根据我们的分析，设备端解除绑定命令不包括任何用户凭证。因此，攻击者可以构建一个虚拟设备，使用设备端API伪造解除绑定请求。受害者用户的帐户和设备之间的绑定关系在用户不知情的情况下被撤销</p>
</li>
</ol>
<h4 id="6实验过程">6.实验过程</h4>
<ol>
<li>
<p>实验装置</p>
<p>1型：Alink设备（型号为SPS9011A的飞利浦智能插头）</p>
<p>2型：一个TP-LINK设备（型号为LB110的WiFi灯泡）</p>
</li>
<li>
<p>实验过程（具体见论文）</p>
<p>1.远程恶意注册</p>
<p>2.远程设备替代</p>
<p>3.远程设备劫持</p>
<p>4.远程设备Dos</p>
<p>5.非法占用设备</p>
</li>
</ol>
<h4 id="7可继续研究的点">7.可继续研究的点</h4>
<p>未提供</p>
<h4 id="8-开源信息">8. 开源信息</h4>
<p>未开源</p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>anfieldqi </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=http://anfieldqi.top/2020/discovering_and_understanding_the_security_hazards_in_the_interactions/>http://anfieldqi.top/2020/discovering_and_understanding_the_security_hazards_in_the_interactions/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                除特别标注，文章采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="http://anfieldqi.top/tags/iot/">
                    #iot</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="http://anfieldqi.top">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="http://anfieldqi.top/2020/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94_%E5%A6%82%E4%BB%8A%E5%80%BE%E5%B0%BD%E5%85%A5%E6%B5%B7%E6%B5%81/" class="prev" rel="prev" title="生活随笔_如今倾尽入海流"><i class="iconfont icon-left"></i>&nbsp;生活随笔_如今倾尽入海流</a>
         
        
        <a href="http://anfieldqi.top/2020/%E5%9B%BA%E4%BB%B6%E6%94%BB%E5%87%BB%E9%9D%A2%E6%80%BB%E7%BB%93/" class="next" rel="next" title="固件攻击面总结">固件攻击面总结&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
          
<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  const gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: 'xxoo',
    owner: 'xxoo',
    admin: ['xxoo'],
    id: location.pathname, 
    distractionFreeMode: false 
  });
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
      return;
    }
    gitalk.render('gitalk-container');
  })();
</script>

    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="http://anfieldqi.top">anfieldqi</a> | </span> 
         

         
            <a href="http://www.beian.miit.gov.cn/" target="_blank" rel="external nofollow">京ICP备20032128号 </a> |
         
		  <span>power by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> </span> 
    </div>
</footer>













    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
